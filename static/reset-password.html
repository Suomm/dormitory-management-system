<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="utf-8">
	<title>权益保障部-重置密码</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="icon" href="/images/favicon.ico">
	<link rel="stylesheet" href="/lib/layui-v2.5.5/css/layui.css" media="all">
	<link rel="stylesheet" href="css/main.css" media="all"/>
</head>
<body>
<div class="layui-container layui-hide">
    <div class="admin-login-background">
        <div class="layui-form login-form">
			<div class="layui-form-item logo-title">
				<h1>重置密码</h1>
			</div>
			<div class="layui-form-item">
				<label class="layui-icon layui-icon-password"></label>
				<input type="password" id="password" name="password" lay-verify="required" lay-reqtext="请输入密码" placeholder="请输入密码" class="layui-input" value="59741wangshuai">
			</div>
			<div class="layui-form-item">
				<label class="layui-icon layui-icon-password" for="password"></label>
				<input type="password" name="pwd" lay-verify="required" lay-reqtext="请输入密码" placeholder="请输入密码" class="layui-input" value="59741wangshuai">
			</div>
			<div class="layui-form-item">
				<button class="layui-btn layui-btn layui-btn-normal layui-btn-fluid" lay-submit lay-filter="reset">确 定</button>
			</div>
        </div>
    </div>
</div>
<script src="lib/layui-v2.5.5/layui.js" charset="utf-8"></script>
<script src="js/lay-config.js?v=2.0.0" charset="utf-8"></script>
<script type="text/javascript">
    layui.use(['form', 'jquery.particleground'], function () {
        var form = layui.form,
            layer = layui.layer;
        // 粒子线条背景
        $(document).ready(function(){
            $('.layui-container').particleground({
                dotColor:'#7ec7fd',
                lineColor:'#7ec7fd'
            });
            var params = {};
			window.location.search.substring(1).split("&").forEach(function (e) {
				var pair = e.split("=");
				params[pair[0]] = pair[1];
			});
			if (params.id && params.sid) {
				$.post("/user/checkup", params, function (res) {
					if (res) $('.layui-container').removeClass('layui-hide');
					else layer.alert('链接有误或者已经失效', {icon: 5});
				});
			} else {
				layer.alert('链接不完整', {icon: 5});
			}
        });
        // 进行登录操作
        form.on('submit(reset)', function (data) {
            data = data.field;
			if (data.password != data.pwd) {
				layer.msg('两次输入的密码不一致', {icon: 5, shift: 6});
				return false;
			}
			var id = window.location.pathname.split('/')[3];
			$.post("/user/reset-password/" + id, {
				"password": $('#password').val()
			}).done(function () {
				window.location.pathname = '/login.html';
			});
            return false;
        });
    });
</script>
</body>
</html>